<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8" />
  <title>Classificaci贸 - Club de Pesca Torres de Segre</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Classificaci贸 oficial del Club de Pesca Torres de Segre."/>
  <link rel="icon" href="favicon.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>

<header>
  <div class="container">
    <nav>
      <div class="logo"> Club de Pesca Torres de Segre</div>
      <div class="nav-links">
        <a href="index.html">Inici</a>
        <a href="classificacio.html" class="active">Classificaci贸</a>
        <a href="calendari.html">Calendari</a>
        <a href="normes.html">Normes</a>
        <a href="botiga.html">Botiga</a>
        <a href="galeria.html">Galeria</a>
        <a href="contacte.html">Contacte</a>
      </div>
    </nav>
  </div>
</header>

<main class="container">
  <div class="card">
    <div class="table-top">
      <div>
        <h1>Classificaci贸 final</h1>
        <p class="descripcio">Punts totals acumulats (fi de temporada).</p>
      </div>

      <div class="table-actions">
        <input id="q" type="search" placeholder="Cercar pescador..." aria-label="Cercar" />
        <button id="toggleSort" title="Ordenar per punts / posici贸">Ordena per punts</button>
      </div>
    </div>

    <div class="table-wrap" role="region" aria-label="Taula de classificaci贸" tabindex="0">
      <table class="pro-table" id="table">
        <thead>
          <tr>
            <th data-col="pos">P</th>
            <th data-col="nom">Nom</th>
            <th data-col="punts">Puntuaci贸 final</th>
          </tr>
        </thead>
        <tbody id="rows"></tbody>
      </table>
    </div>
  </div>
</main>

<footer>
  Club de Pesca Torres de Segre 路 Lliga Individual 2025
</footer>

<script>
  // DADES (les que em vas donar)
  const data = [
    { pos: 1,  nom: "JANA TEIXIDO",          punts: 92 },
    { pos: 2,  nom: "PAU BERCERO",          punts: 80 },
    { pos: 3,  nom: "XAVI MESALLES",        punts: 27 },
    { pos: 4,  nom: "PAQUITO TORREGUITART", punts: 15 },
    { pos: 5,  nom: "XIMPI",                punts: 0  },
    { pos: 6,  nom: "RAMON VILAGINS",      punts: 0  },
    { pos: 7,  nom: "DAVID HERNANDEZ",      punts: 0  },
    { pos: 8,  nom: "YASSIN RUIZ",          punts: 0  },
    { pos: 9,  nom: "ANGEL VIZCAINO",       punts: 0  },
    { pos: 10, nom: "FLORIN CULCEA",        punts: 0  }
  ];

  const tbody = document.getElementById("rows");
  const q = document.getElementById("q");
  const toggleSort = document.getElementById("toggleSort");
  const ths = Array.from(document.querySelectorAll("th[data-col]"));

  let sortMode = "pos"; // pos | punts | nom
  let sortDir = "asc";  // asc | desc

  function render(){
    const query = q.value.trim().toLowerCase();

    let rows = data.filter(r => r.nom.toLowerCase().includes(query));

    rows.sort((a,b) => {
      let A = a[sortMode], B = b[sortMode];

      // strings
      if (typeof A === "string") {
        A = A.toLowerCase(); B = B.toLowerCase();
        if (A < B) return sortDir === "asc" ? -1 : 1;
        if (A > B) return sortDir === "asc" ?  1 : -1;
        return 0;
      }

      // numbers
      if (A === B) return 0;
      return sortDir === "asc" ? (A - B) : (B - A);
    });

    tbody.innerHTML = rows.map(r => `
      <tr>
        <td><strong>${r.pos}</strong></td>
        <td>${escapeHtml(r.nom)}</td>
        <td><strong>${r.punts}</strong></td>
      </tr>
    `).join("");
  }

  function escapeHtml(str){
    return str
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  // Buscar
  q.addEventListener("input", render);

  // Bot贸n r谩pido: alterna pos <-> punts
  toggleSort.addEventListener("click", () => {
    if (sortMode !== "punts") {
      sortMode = "punts"; sortDir = "desc";
      toggleSort.textContent = "Ordena per posici贸";
    } else {
      sortMode = "pos"; sortDir = "asc";
      toggleSort.textContent = "Ordena per punts";
    }
    render();
  });

  // Click en columnas para ordenar
  ths.forEach(th => {
    th.addEventListener("click", () => {
      const col = th.dataset.col;

      if (sortMode === col) {
        sortDir = (sortDir === "asc") ? "desc" : "asc";
      } else {
        sortMode = col;
        sortDir = (col === "punts") ? "desc" : "asc";
      }

      // Texto del bot贸n en funci贸n del modo
      if (sortMode === "punts") toggleSort.textContent = "Ordena per posici贸";
      else toggleSort.textContent = "Ordena per punts";

      render();
    });
  });

  render();
</script>

</body>
</html>
